<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - Personal Wings</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script> window.FontAwesomeConfig = { autoReplaceSvg: 'nest' };</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        ::-webkit-scrollbar {
            display: none;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .password-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .input-focus:focus {
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            border-color: #6366F1;
        }

        .btn-primary {
            background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
        }

        .plane-animation {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(2deg);
            }
        }

        .cloud {
            animation: drift 20s linear infinite;
        }

        @keyframes drift {
            0% {
                transform: translateX(-100px);
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                transform: translateX(100px);
                opacity: 0;
            }
        }

        .pulse-glow {
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 0 5px rgba(99, 102, 241, 0.5);
            }

            50% {
                box-shadow: 0 0 20px rgba(99, 102, 241, 0.8);
            }
        }

        .password-strength {
            height: 4px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .otp-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            border: 2px solid #E5E7EB;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .otp-input:focus {
            border-color: #6366F1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .otp-input.filled {
            border-color: #10B981;
            background-color: #F0FDF4;
        }

        .countdown {
            font-variant-numeric: tabular-nums;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366F1',
                        secondary: '#0F172A',
                        accent: '#10B981',
                        background: '#F5F6FA',
                        sidebar: '#111827',
                        card: '#FFFFFF'
                    }
                }
            }
        }
    </script>
</head>

<body class="p-4">
    <!-- Animated Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <!-- Clouds -->
        <div class="cloud absolute top-1/4 left-1/4 text-white/10">
            <i class="fa-solid fa-cloud text-6xl"></i>
        </div>
        <div class="cloud absolute top-1/3 right-1/4 text-white/10" style="animation-delay: -5s;">
            <i class="fa-solid fa-cloud text-4xl"></i>
        </div>
        <div class="cloud absolute bottom-1/4 left-1/3 text-white/10" style="animation-delay: -10s;">
            <i class="fa-solid fa-cloud text-5xl"></i>
        </div>

        <!-- Floating Plane -->
        <div class="plane-animation absolute top-1/2 right-1/4 text-white/20">
            <i class="fa-solid fa-plane-departure text-8xl transform -rotate-45"></i>
        </div>
    </div>

    <!-- Forgot Password Container -->
    <div id="forgotPasswordContainer"
        class="password-container rounded-3xl shadow-2xl w-full max-w-md mx-auto overflow-hidden">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-primary to-purple-600 p-8 text-center text-white">
            <div class="flex items-center justify-center space-x-3 mb-4">
                <div class="w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center pulse-glow">
                    <i class="fa-solid fa-key text-2xl"></i>
                </div>
                <h1 class="text-3xl font-bold">Personal Wings</h1>
            </div>
            <p class="text-white/80 text-sm">Reset Your Password</p>
        </div>

        <!-- Forgot Password Form -->
        <div class="p-8">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Forgot Password?</h2>
                <p class="text-gray-600">Enter your email to receive a password reset link</p>
            </div>

            <form id="forgotPasswordForm" class="space-y-6">
                <!-- Email Field -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fa-solid fa-envelope mr-2 text-primary"></i>
                        Email Address
                    </label>
                    <div class="relative">
                        <input type="email" id="forgotEmail" required
                            class="w-full px-4 py-3 pl-11 border border-gray-200 rounded-xl input-focus focus:outline-none transition-colors"
                            placeholder="admin@personalwings.com">
                        <i class="fa-solid fa-at absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>

                <!-- Send Reset Link Button -->
                <button type="submit" class="w-full btn-primary text-white py-3 rounded-xl font-semibold shadow-lg">
                    <i class="fa-solid fa-paper-plane mr-2"></i>
                    Send Reset Link
                </button>

                <!-- Back to Login -->
                <div class="text-center">
                    <a href="#" class="text-primary hover:text-primary/80 transition-colors text-sm">
                        <i class="fa-solid fa-arrow-left mr-1"></i>
                        Back to Login
                    </a>
                </div>
            </form>

            <!-- Security Info -->
            <div class="mt-8 p-4 bg-blue-50 rounded-xl border border-blue-200">
                <h4 class="text-sm font-semibold text-blue-800 mb-2 flex items-center">
                    <i class="fa-solid fa-shield-check mr-2"></i>
                    Security Notice
                </h4>
                <div class="text-xs text-blue-600 space-y-1">
                    <div>• Reset link expires in 1 hour</div>
                    <div>• Check your spam folder if you don't see the email</div>
                    <div>• Contact support if you need assistance</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reset Password Container -->
    <div id="resetPasswordContainer"
        class="password-container rounded-3xl shadow-2xl w-full max-w-md mx-auto overflow-hidden hidden">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-primary to-purple-600 p-8 text-center text-white">
            <div class="flex items-center justify-center space-x-3 mb-4">
                <div class="w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center pulse-glow">
                    <i class="fa-solid fa-lock text-2xl"></i>
                </div>
                <h1 class="text-3xl font-bold">Personal Wings</h1>
            </div>
            <p class="text-white/80 text-sm">Create New Password</p>
        </div>

        <!-- Reset Password Form -->
        <div class="p-8">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Reset Password</h2>
                <p class="text-gray-600">Create a new secure password for your account</p>
            </div>

            <form id="resetPasswordForm" class="space-y-6">
                <!-- New Password -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fa-solid fa-lock mr-2 text-primary"></i>
                        New Password *
                    </label>
                    <div class="relative">
                        <input type="password" id="newPassword" required
                            class="w-full px-4 py-3 pl-11 pr-11 border border-gray-200 rounded-xl input-focus focus:outline-none transition-colors"
                            placeholder="Create a strong password">
                        <i class="fa-solid fa-key absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <button type="button" id="toggleNewPassword"
                            class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors">
                            <i class="fa-solid fa-eye"></i>
                        </button>
                    </div>

                    <!-- Password Strength Meter -->
                    <div class="mt-2 space-y-2">
                        <div class="flex space-x-1">
                            <div id="strength-1" class="password-strength flex-1 bg-gray-200"></div>
                            <div id="strength-2" class="password-strength flex-1 bg-gray-200"></div>
                            <div id="strength-3" class="password-strength flex-1 bg-gray-200"></div>
                            <div id="strength-4" class="password-strength flex-1 bg-gray-200"></div>
                        </div>
                        <div id="passwordFeedback" class="text-xs text-gray-500"></div>
                    </div>

                    <!-- Password Requirements -->
                    <div class="mt-3 space-y-1 text-xs text-gray-500">
                        <div class="flex items-center space-x-2">
                            <i class="fa-solid fa-check w-4 text-green-500"></i>
                            <span>At least 8 characters</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fa-solid fa-check w-4 text-green-500"></i>
                            <span>Uppercase and lowercase letters</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fa-solid fa-check w-4 text-green-500"></i>
                            <span>At least one number</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <i class="fa-solid fa-check w-4 text-green-500"></i>
                            <span>At least one special character</span>
                        </div>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fa-solid fa-lock mr-2 text-primary"></i>
                        Confirm New Password *
                    </label>
                    <div class="relative">
                        <input type="password" id="confirmNewPassword" required
                            class="w-full px-4 py-3 pl-11 pr-11 border border-gray-200 rounded-xl input-focus focus:outline-none transition-colors"
                            placeholder="Confirm your new password">
                        <i class="fa-solid fa-key absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <button type="button" id="toggleConfirmNewPassword"
                            class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors">
                            <i class="fa-solid fa-eye"></i>
                        </button>
                    </div>
                    <div id="passwordMatch" class="mt-2 text-xs"></div>
                </div>

                <!-- Reset Password Button -->
                <button type="submit" id="resetPasswordBtn"
                    class="w-full btn-primary text-white py-3 rounded-xl font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled>
                    <i class="fa-solid fa-key mr-2"></i>
                    Reset Password
                </button>

                <!-- Back to Forgot Password -->
                <div class="text-center">
                    <button type="button" id="backToForgot"
                        class="text-primary hover:text-primary/80 transition-colors text-sm">
                        <i class="fa-solid fa-arrow-left mr-1"></i>
                        Back to Forgot Password
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- OTP Verification Container -->
    <div id="otpVerificationContainer"
        class="password-container rounded-3xl shadow-2xl w-full max-w-md mx-auto overflow-hidden hidden">
        <!-- Header Section -->
        <div class="bg-gradient-to-r from-primary to-purple-600 p-8 text-center text-white">
            <div class="flex items-center justify-center space-x-3 mb-4">
                <div class="w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center pulse-glow">
                    <i class="fa-solid fa-shield-halved text-2xl"></i>
                </div>
                <h1 class="text-3xl font-bold">Personal Wings</h1>
            </div>
            <p class="text-white/80 text-sm">Verify Your Identity</p>
        </div>

        <!-- OTP Verification Form -->
        <div class="p-8">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Enter Verification Code</h2>
                <p class="text-gray-600" id="otpDeliveryInfo">Code sent to admin@personalwings.com</p>
            </div>

            <form id="otpVerificationForm" class="space-y-6">
                <!-- OTP Input Fields -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-3 text-center">
                        Enter 6-digit verification code
                    </label>
                    <div class="flex justify-center space-x-3 mb-4">
                        <input type="text" maxlength="1" class="otp-input" data-index="1" inputmode="numeric"
                            pattern="[0-9]">
                        <input type="text" maxlength="1" class="otp-input" data-index="2" inputmode="numeric"
                            pattern="[0-9]">
                        <input type="text" maxlength="1" class="otp-input" data-index="3" inputmode="numeric"
                            pattern="[0-9]">
                        <input type="text" maxlength="1" class="otp-input" data-index="4" inputmode="numeric"
                            pattern="[0-9]">
                        <input type="text" maxlength="1" class="otp-input" data-index="5" inputmode="numeric"
                            pattern="[0-9]">
                        <input type="text" maxlength="1" class="otp-input" data-index="6" inputmode="numeric"
                            pattern="[0-9]">
                    </div>
                    <input type="hidden" id="fullOtp">
                </div>

                <!-- Countdown Timer -->
                <div class="text-center">
                    <div class="text-sm text-gray-600 mb-2">
                        Code expires in:
                        <span id="countdown" class="countdown font-semibold text-primary">10:00</span>
                    </div>
                    <button type="button" id="resendOtp"
                        class="text-primary hover:text-primary/80 transition-colors text-sm disabled:text-gray-400 disabled:cursor-not-allowed"
                        disabled>
                        <i class="fa-solid fa-rotate mr-1"></i>
                        Resend Code (<span id="resendTimer">60</span>s)
                    </button>
                </div>

                <!-- Verify Button -->
                <button type="submit" id="verifyOtpBtn"
                    class="w-full btn-primary text-white py-3 rounded-xl font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled>
                    <i class="fa-solid fa-check mr-2"></i>
                    Verify & Continue
                </button>

                <!-- Change Email -->
                <div class="text-center">
                    <button type="button" id="changeEmail"
                        class="text-primary hover:text-primary/80 transition-colors text-sm">
                        <i class="fa-solid fa-pen mr-1"></i>
                        Change Email Address
                    </button>
                </div>
            </form>

            <!-- Demo OTP -->
            <div class="mt-8 p-4 bg-green-50 rounded-xl border border-green-200">
                <h4 class="text-sm font-semibold text-green-800 mb-2 flex items-center">
                    <i class="fa-solid fa-key mr-2"></i>
                    Demo OTP Code
                </h4>
                <div class="text-center">
                    <code class="text-lg font-mono font-bold text-green-600">123456</code>
                    <div class="text-xs text-green-600 mt-1">Use this code for testing</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-8 text-center shadow-2xl">
            <div
                class="w-16 h-16 bg-gradient-to-r from-primary to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-shield-halved text-white text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-2" id="loadingTitle">Processing</h3>
            <p class="text-gray-600 mb-4" id="loadingMessage">Please wait while we process your request...</p>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div id="progressBar"
                    class="bg-gradient-to-r from-primary to-purple-600 h-2 rounded-full transition-all duration-3000"
                    style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-2xl p-8 text-center shadow-2xl max-w-sm mx-4">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa-solid fa-check text-green-600 text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-2">Password Reset Successful!</h3>
            <p class="text-gray-600 mb-6">Your password has been updated successfully.</p>
            <button id="continueToLogin" class="w-full btn-primary text-white py-3 rounded-xl font-semibold">
                Continue to Login
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const forgotPasswordContainer = document.getElementById('forgotPasswordContainer');
            const resetPasswordContainer = document.getElementById('resetPasswordContainer');
            const otpVerificationContainer = document.getElementById('otpVerificationContainer');
            const forgotPasswordForm = document.getElementById('forgotPasswordForm');
            const resetPasswordForm = document.getElementById('resetPasswordForm');
            const otpVerificationForm = document.getElementById('otpVerificationForm');
            const loadingOverlay = document.getElementById('loadingOverlay');
            const progressBar = document.getElementById('progressBar');
            const successModal = document.getElementById('successModal');
            const continueToLogin = document.getElementById('continueToLogin');
            const backToForgot = document.getElementById('backToForgot');
            const changeEmail = document.getElementById('changeEmail');

            let userEmail = '';
            let countdown;
            let resendCountdown;

            // Forgot Password Form Submission
            forgotPasswordForm.addEventListener('submit', function (e) {
                e.preventDefault();

                userEmail = document.getElementById('forgotEmail').value;

                if (!userEmail) {
                    showNotification('Please enter your email address.', 'error');
                    return;
                }

                showLoading('Sending Reset Link', 'Sending password reset instructions to your email...');

                // Simulate API call
                setTimeout(() => {
                    hideLoading();

                    // Switch to OTP verification (simulating email sent)
                    forgotPasswordContainer.classList.add('hidden');
                    otpVerificationContainer.classList.remove('hidden');

                    // Update delivery info
                    document.getElementById('otpDeliveryInfo').textContent = `Code sent to ${userEmail}`;

                    // Start timers
                    startCountdown();
                    startResendTimer();

                    showNotification(`Password reset instructions sent to ${userEmail}`, 'success');
                }, 2000);
            });

            // OTP Input Handling
            const otpInputs = document.querySelectorAll('.otp-input');
            const fullOtpInput = document.getElementById('fullOtp');
            const verifyOtpBtn = document.getElementById('verifyOtpBtn');

            otpInputs.forEach((input, index) => {
                input.addEventListener('input', function (e) {
                    const value = e.target.value;

                    if (!/^\d*$/.test(value)) {
                        e.target.value = '';
                        return;
                    }

                    if (value && index < otpInputs.length - 1) {
                        otpInputs[index + 1].focus();
                    }

                    if (value) {
                        e.target.classList.add('filled');
                    } else {
                        e.target.classList.remove('filled');
                    }

                    updateFullOtp();
                    checkOtpCompletion();
                });

                input.addEventListener('keydown', function (e) {
                    if (e.key === 'Backspace') {
                        if (!e.target.value && index > 0) {
                            otpInputs[index - 1].focus();
                        }
                        e.target.classList.remove('filled');
                    }

                    if (e.key === 'v' && (e.ctrlKey || e.metaKey)) {
                        setTimeout(() => {
                            handlePaste(e.target, index);
                        }, 0);
                    }
                });

                input.addEventListener('paste', function (e) {
                    e.preventDefault();
                    handlePaste(e.target, index);
                });
            });

            function handlePaste(target, index) {
                const pasteData = (event.clipboardData || window.clipboardData).getData('text');
                const numbers = pasteData.replace(/\D/g, '').split('').slice(0, 6);

                numbers.forEach((num, numIndex) => {
                    const inputIndex = index + numIndex;
                    if (inputIndex < otpInputs.length) {
                        otpInputs[inputIndex].value = num;
                        otpInputs[inputIndex].classList.add('filled');
                    }
                });

                const lastFilledIndex = Math.min(index + numbers.length - 1, otpInputs.length - 1);
                if (lastFilledIndex < otpInputs.length) {
                    otpInputs[lastFilledIndex].focus();
                }

                updateFullOtp();
                checkOtpCompletion();
            }

            function updateFullOtp() {
                const otp = Array.from(otpInputs).map(input => input.value).join('');
                fullOtpInput.value = otp;
            }

            function checkOtpCompletion() {
                const otp = fullOtpInput.value;
                const isComplete = otp.length === 6;
                verifyOtpBtn.disabled = !isComplete;
            }

            // OTP Verification Form Submission
            otpVerificationForm.addEventListener('submit', function (e) {
                e.preventDefault();

                const otp = fullOtpInput.value;

                if (otp.length !== 6) {
                    showNotification('Please enter the complete 6-digit code.', 'error');
                    return;
                }

                showLoading('Verifying Code', 'Please wait while we verify your code...');

                setTimeout(() => {
                    hideLoading();

                    // Demo OTP check
                    if (otp === '123456') {
                        otpVerificationContainer.classList.add('hidden');
                        resetPasswordContainer.classList.remove('hidden');
                        clearInterval(countdown);
                        clearInterval(resendCountdown);
                        showNotification('Identity verified. Please create a new password.', 'success');
                    } else {
                        showNotification('Invalid verification code. Please try again.', 'error');
                        otpInputs.forEach(input => {
                            input.value = '';
                            input.classList.remove('filled');
                        });
                        updateFullOtp();
                        checkOtpCompletion();
                        otpInputs[0].focus();
                    }
                }, 1500);
            });

            // Password Strength and Matching
            const newPasswordInput = document.getElementById('newPassword');
            const confirmNewPasswordInput = document.getElementById('confirmNewPassword');
            const toggleNewPassword = document.getElementById('toggleNewPassword');
            const toggleConfirmNewPassword = document.getElementById('toggleConfirmNewPassword');
            const resetPasswordBtn = document.getElementById('resetPasswordBtn');

            // Toggle password visibility
            toggleNewPassword.addEventListener('click', function () {
                const type = newPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                newPasswordInput.setAttribute('type', type);
                this.querySelector('i').className = type === 'password' ? 'fa-solid fa-eye' : 'fa-solid fa-eye-slash';
            });

            toggleConfirmNewPassword.addEventListener('click', function () {
                const type = confirmNewPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                confirmNewPasswordInput.setAttribute('type', type);
                this.querySelector('i').className = type === 'password' ? 'fa-solid fa-eye' : 'fa-solid fa-eye-slash';
            });

            // Password strength checker
            newPasswordInput.addEventListener('input', function () {
                checkPasswordStrength(this.value);
                checkPasswordMatch();
                checkResetButton();
            });

            confirmNewPasswordInput.addEventListener('input', function () {
                checkPasswordMatch();
                checkResetButton();
            });

            function checkPasswordStrength(password) {
                const strengthBars = [
                    document.getElementById('strength-1'),
                    document.getElementById('strength-2'),
                    document.getElementById('strength-3'),
                    document.getElementById('strength-4')
                ];
                const feedback = document.getElementById('passwordFeedback');

                let strength = 0;
                let messages = [];

                // Reset bars
                strengthBars.forEach(bar => {
                    bar.className = 'password-strength flex-1 bg-gray-200';
                });

                if (password.length >= 8) strength++;
                if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength++;
                if (password.match(/\d/)) strength++;
                if (password.match(/[^a-zA-Z\d]/)) strength++;

                // Update strength bars
                for (let i = 0; i < strength; i++) {
                    if (strength === 1) {
                        strengthBars[i].className = 'password-strength flex-1 bg-red-500';
                    } else if (strength === 2) {
                        strengthBars[i].className = 'password-strength flex-1 bg-yellow-500';
                    } else if (strength === 3) {
                        strengthBars[i].className = 'password-strength flex-1 bg-blue-500';
                    } else if (strength === 4) {
                        strengthBars[i].className = 'password-strength flex-1 bg-green-500';
                    }
                }

                // Update feedback
                if (password.length === 0) {
                    feedback.textContent = '';
                } else if (strength === 1) {
                    feedback.textContent = 'Weak - Add more characters and variety';
                    feedback.className = 'text-xs text-red-500';
                } else if (strength === 2) {
                    feedback.textContent = 'Fair - Add numbers or special characters';
                    feedback.className = 'text-xs text-yellow-500';
                } else if (strength === 3) {
                    feedback.textContent = 'Good - Strong password';
                    feedback.className = 'text-xs text-blue-500';
                } else if (strength === 4) {
                    feedback.textContent = 'Excellent - Very strong password';
                    feedback.className = 'text-xs text-green-500';
                }
            }

            function checkPasswordMatch() {
                const matchElement = document.getElementById('passwordMatch');
                const password = newPasswordInput.value;
                const confirmPassword = confirmNewPasswordInput.value;

                if (confirmPassword.length === 0) {
                    matchElement.textContent = '';
                } else if (password === confirmPassword) {
                    matchElement.textContent = 'Passwords match';
                    matchElement.className = 'text-xs text-green-500';
                } else {
                    matchElement.textContent = 'Passwords do not match';
                    matchElement.className = 'text-xs text-red-500';
                }
            }

            function checkResetButton() {
                const password = newPasswordInput.value;
                const confirmPassword = confirmNewPasswordInput.value;
                const isStrong = password.length >= 8 &&
                    password.match(/[a-z]/) &&
                    password.match(/[A-Z]/) &&
                    password.match(/\d/) &&
                    password.match(/[^a-zA-Z\d]/);
                const isMatching = password === confirmPassword && password.length > 0;

                resetPasswordBtn.disabled = !(isStrong && isMatching);
            }

            // Reset Password Form Submission
            resetPasswordForm.addEventListener('submit', function (e) {
                e.preventDefault();

                const password = newPasswordInput.value;
                const confirmPassword = confirmNewPasswordInput.value;

                if (password !== confirmPassword) {
                    showNotification('Passwords do not match.', 'error');
                    return;
                }

                if (password.length < 8) {
                    showNotification('Password must be at least 8 characters long.', 'error');
                    return;
                }

                showLoading('Resetting Password', 'Updating your password...');

                setTimeout(() => {
                    hideLoading();
                    successModal.classList.remove('hidden');
                    showNotification('Password reset successfully!', 'success');
                }, 2000);
            });

            // Navigation
            backToForgot.addEventListener('click', function () {
                resetPasswordContainer.classList.add('hidden');
                forgotPasswordContainer.classList.remove('hidden');
            });

            changeEmail.addEventListener('click', function () {
                otpVerificationContainer.classList.add('hidden');
                forgotPasswordContainer.classList.remove('hidden');
                clearInterval(countdown);
                clearInterval(resendCountdown);
            });

            continueToLogin.addEventListener('click', function () {
                successModal.classList.add('hidden');
                showNotification('Please login with your new password.', 'success');
                // In real app: window.location.href = '/login';
                setTimeout(() => {
                    alert('Redirecting to login page...');
                }, 1000);
            });

            // Timer Functions
            function startCountdown() {
                let timeLeft = 600; // 10 minutes

                countdown = setInterval(() => {
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    document.getElementById('countdown').textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                    if (timeLeft <= 0) {
                        clearInterval(countdown);
                        showNotification('Verification code has expired.', 'error');
                        verifyOtpBtn.disabled = true;
                    }

                    timeLeft--;
                }, 1000);
            }

            function startResendTimer() {
                let timeLeft = 60;
                const resendOtpBtn = document.getElementById('resendOtp');
                const resendTimerElement = document.getElementById('resendTimer');

                resendOtpBtn.disabled = true;

                resendCountdown = setInterval(() => {
                    resendTimerElement.textContent = timeLeft;

                    if (timeLeft <= 0) {
                        clearInterval(resendCountdown);
                        resendOtpBtn.disabled = false;
                        resendTimerElement.textContent = '0';
                    }

                    timeLeft--;
                }, 1000);
            }

            // Resend OTP
            document.getElementById('resendOtp').addEventListener('click', function () {
                if (this.disabled) return;

                showLoading('Resending Code', 'Sending new verification code...');

                setTimeout(() => {
                    hideLoading();
                    startCountdown();
                    startResendTimer();
                    showNotification(`New verification code sent to ${userEmail}`, 'success');
                }, 1500);
            });

            // Utility Functions
            function showLoading(title, message) {
                document.getElementById('loadingTitle').textContent = title;
                document.getElementById('loadingMessage').textContent = message;
                loadingOverlay.classList.remove('hidden');

                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 20;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                    }
                    progressBar.style.width = progress + '%';
                }, 100);
            }

            function hideLoading() {
                loadingOverlay.classList.add('hidden');
                progressBar.style.width = '0%';
            }

            function showNotification(message, type) {
                const existingNotification = document.querySelector('.notification');
                if (existingNotification) {
                    existingNotification.remove();
                }

                const notification = document.createElement('div');
                notification.className = `notification fixed top-4 right-4 p-4 rounded-xl shadow-lg text-white z-50 transform transition-transform duration-300 ${type === 'error' ? 'bg-red-500' :
                    type === 'success' ? 'bg-green-500' : 'bg-blue-500'
                    }`;

                notification.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <i class="fa-solid ${type === 'error' ? 'fa-circle-exclamation' :
                        type === 'success' ? 'fa-circle-check' : 'fa-circle-info'
                    }"></i>
                        <span>${message}</span>
                    </div>
                `;

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => notification.remove(), 300);
                }, 4000);
            }
        });
    </script>
</body>

</html>